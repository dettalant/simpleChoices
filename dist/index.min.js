/*!
 *   simpleChoices.js
 *
 * @author dettalant
 * @version v0.1.0
 * @license MIT License
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const createDiv=e=>{const t=document.createElement("div");return e&&(t.className=e),t},createSpan=e=>{const t=document.createElement("span");return e&&(t.className=e),t},createButton=e=>{const t=document.createElement("button");return e&&(t.className=e),t.type="button",t},setAriaSelected=(e,t)=>e.setAttribute("aria-selected",t.toString()),setAriaExpanded=(e,t)=>e.setAttribute("aria-expanded",t.toString());class SimpleSelectBuilder{constructor(e={}){this.classNames=Object.assign(this.defaultSelectClassNames,e)}get defaultSelectClassNames(){return{container:"simpleSelect_container",label:"simpleSelect_label",wrapper:"simpleSelect_wrapper",itemWrapper:"simpleSelect_itemWrapper",item:"simpleSelect_item",current:"simpleSelect_currentItem"}}create(e,t,r,s){const n=this.genSelectElements(t,r,s);return new SimpleSelect(e,n,r)}genSelectElements(e,t,r=""){const s=this.classNames,n=createButton(s.container+" "+r),i=createSpan(s.label);i.textContent=e;const a=createDiv(s.wrapper),c=createSpan(s.current);c.textContent=t[0].label;const l=createDiv(s.itemWrapper);[n,l].forEach(e=>setAriaExpanded(e,!1));const d=t.map((e,t)=>{const r=s.item+" "+s.item+t,n=createDiv(r);return n.textContent=e.label,n.dataset.itemIdx=t.toString(),setAriaSelected(n,0===t),l.appendChild(n),n});return[c,l].forEach(e=>a.appendChild(e)),[i,a].forEach(e=>n.appendChild(e)),{container:n,label:i,current:c,wrapper:a,itemWrapper:l,items:d}}}class SimpleSelect{constructor(e,t,r){this._currentIdx=0,this.selectId=e,this.el=t,this.items=r,this.applyEventListeners()}dispatchSelectItemEvent(e){const t=new CustomEvent("SimpleSelectItemEvent",{detail:this.items[e].value});this.el.container.dispatchEvent(t)}updateHighlightItem(e){if(e>=this.el.items.length)return;this.el.items.forEach(e=>{setAriaSelected(e,!1)});const t=this.el.items[e];setAriaSelected(t,!0),this._currentIdx=e}updateCurrentItem(e){const t=this.items[e];t&&(this.el.current.textContent=t.label)}applyEventListeners(){const{container:e,itemWrapper:t,items:r}=this.el;e.addEventListener("focus",()=>{[e,t].forEach(e=>setAriaExpanded(e,!0))}),e.addEventListener("blur",()=>{[e,t].forEach(e=>setAriaExpanded(e,!1))}),e.addEventListener("keydown",t=>{t.stopPropagation();const r="ArrowDown"===t.key||40===t.keyCode,s="ArrowUp"===t.key||38===t.keyCode,n="Enter"===t.key||13===t.keyCode;if(s){const e=this._currentIdx>0?--this._currentIdx:0;this.updateHighlightItem(e)}else if(r){const e=this._currentIdx<this.items.length-1?++this._currentIdx:this._currentIdx;this.updateHighlightItem(e)}else if(n){const t=this._currentIdx;this.updateCurrentItem(t),this.dispatchSelectItemEvent(t),e.blur()}}),r.forEach(t=>{t.addEventListener("mouseenter",()=>{const e=parseInt(t.dataset.itemIdx||"",10);this.updateHighlightItem(e)}),t.addEventListener("click",()=>{const r=parseInt(t.dataset.itemIdx||"",10);this.updateCurrentItem(r),this.dispatchSelectItemEvent(r),e.blur()})})}}exports.SimpleSelectBuilder=SimpleSelectBuilder;
